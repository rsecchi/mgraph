function [Za1,Za2]=calcola(Z1)

R11=real(Z1(1,1)); X11=imag(Z1(1,1));
R12=real(Z1(1,2)); X12=imag(Z1(1,2));
R21=real(Z1(2,1)); X21=imag(Z1(2,1));
R22=real(Z1(2,2)); X22=imag(Z1(2,2));

Za1=-(sqrt(X22^4+(-2*X21-2*X12)*X22^3+(X21^2+4*X12*X21+X12^2+2*R22^2+(-2*R21-2*R12)*R22-2*R12*R21)*X22^2+
(-2*X12*X21^2+(-2*X12^2-2*R22^2+(2*R21+6*R12)*R22+2*R12*R21)*X21+(-2*R22^2+(6*R21+2*R12)*R22+2*R12*R21)*X12+(-4*R21-4*R12)*R22*X11)*X22+
(X12^2-4*R12*R22)*X21^2+((-2*R22^2+(-2*R21-2*R12)*R22-2*R12*R21)*X12+(4*R22^2+4*R12*R22)*X11)*X21-4*R21*R22*X12^2+(4*R22^2+4*R21*R22)*X11*X12-
4*R22^2*X11^2+R22^4+(-2*R21-2*R12)*R22^3+(R21^2+4*R12*R21+R12^2)*R22^2+(-2*R12*R21^2-2*R12^2*R21)*R22+R12^2*R21^2)+X22^2+(-X21-X12)*X22+X12*
X21+R22^2+(-R21-R12+2*R11)*R22-R12*R21)/(2*R22);

Za2=(sqrt(X22^4+(-2*X21-2*X12)*X22^3+(X21^2+4*X12*X21+X12^2+2*R22^2+(-2*R21-2*R12)*R22-2*R12*R21)*X22^2+
(-2*X12*X21^2+(-2*X12^2-2*R22^2+(2*R21+6*R12)*R22+2*R12*R21)*X21+(-2*R22^2+(6*R21+2*R12)*R22+2*R12*R21)*X12+(-4*R21-4*R12)*R22*X11)*X22+
(X12^2-4*R12*R22)*X21^2+((-2*R22^2+(-2*R21-2*R12)*R22-2*R12*R21)*X12+(4*R22^2+4*R12*R22)*X11)*X21-4*R21*R22*X12^2+(4*R22^2+4*R21*R22)*X11*X12-
4*R22^2*X11^2+R22^4+(-2*R21-2*R12)*R22^3+(R21^2+4*R12*R21+R12^2)*R22^2+(-2*R12*R21^2-2*R12^2*R21)*R22+R12^2*R21^2)-X22^2+(X21+X12)*X22-X12*X21
-R22^2+(R21+R12-2*R11)*R22+R12*R21)/(2*R22);

C = Z1(1,1)+Z1(2,2)-Z1(1,2)-Z1(2,1);
Zb1= (Z1(2,2)*Za1+det(Z1))/(Za1+C);
Zb2= (Z1(2,2)*Za2+det(Z1))/(Za2+C);

end