function [Zr1,Zr2,Zr3,Zr4,delta1,delta2] = Zphi2(Z,Xb,k=1)
	
	Z11 = Z(1,1);
	Z12 = Z(1,2);
	Z21 = Z(2,1);
	Z22 = Z(2,2);
	
	R11 = real(Z11); X11 = imag(Z11);
	R12 = real(Z12); X12 = imag(Z12);
	R21 = real(Z21); X21 = imag(Z21);
	R22 = real(Z22); X22 = imag(Z22);
	
delta1 = -4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22
delta2 = (-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2
	
Xa1 = -(((R21+R12)*X22-R22*X21-R22*X12)*sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)+(2*R21+2*R12)*R22*Xb^2+((2*R11*R22-R12*R21-R12^2)*X21+(2*R11*R22-R21^2-R12*R21)*X12)*X22-R12*R22*X21^2+(R21+R12)*R22*X12*X21-R21*R22*X12^2+(2*R11*R21+2*R11*R12)*R22^2+(-2*R12*R21^2-2*R12^2*R21)*R22)/((R21+R12)*sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)+(2*R11*R22-R12*R21-R12^2)*X21+(2*R11*R22-R21^2-R12*R21)*X12)
Xc1 = -(sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)-R12*X21-R21*X12+2*R22*X11)/(2*R22)

Xa2 = -(((R21+R12)*X22-R22*X21-R22*X12)*sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)+(-2*R21-2*R12)*R22*Xb^2+((-2*R11*R22+R12*R21+R12^2)*X21+(-2*R11*R22+R21^2+R12*R21)*X12)*X22+R12*R22*X21^2+(-R21-R12)*R22*X12*X21+R21*R22*X12^2+(-2*R11*R21-2*R11*R12)*R22^2+(2*R12*R21^2+2*R12^2*R21)*R22)/((R21+R12)*sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)+(-2*R11*R22+R12*R21+R12^2)*X21+(-2*R11*R22+R21^2+R12*R21)*X12)
Xc2 = (sqrt(-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)+R12*X21+R21*X12-2*R22*X11)/(2*R22)

Xa3 = -(((R21+R12)*X22-R22*X21-R22*X12)*sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+((2*R21+2*R12)*R22*Xb^2+((2*R11*R22-R12*R21-R12^2)*X21+(2*R11*R22-R21^2-R12*R21)*X12)*X22-R12*R22*X21^2+(R21+R12)*R22*X12*X21-R21*R22*X12^2+(2*R11*R21+2*R11*R12)*R22^2+(-2*R12*R21^2-2*R12^2*R21)*R22)*k+((-R21^2-2*R12*R21-R12^2)*X22+(R21+R12)*R22*X21+(R21+R12)*R22*X12)*Xb)/((R21+R12)*sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+((2*R11*R22-R12*R21-R12^2)*X21+(2*R11*R22-R21^2-R12*R21)*X12)*k+(-R21^2-2*R12*R21-R12^2)*Xb)
Xc3 = -(sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+(-R12*X21-R21*X12+2*R22*X11)*k+(-R21-R12)*Xb)/(2*R22*k)

Xa4 = -(((R21+R12)*X22-R22*X21-R22*X12)*sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+((-2*R21-2*R12)*R22*Xb^2+((-2*R11*R22+R12*R21+R12^2)*X21+(-2*R11*R22+R21^2+R12*R21)*X12)*X22+R12*R22*X21^2+(-R21-R12)*R22*X12*X21+R21*R22*X12^2+(-2*R11*R21-2*R11*R12)*R22^2+(2*R12*R21^2+2*R12^2*R21)*R22)*k+((R21^2+2*R12*R21+R12^2)*X22+(-R21-R12)*R22*X21+(-R21-R12)*R22*X12)*Xb)/((R21+R12)*sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+((-2*R11*R22+R12*R21+R12^2)*X21+(-2*R11*R22+R21^2+R12*R21)*X12)*k+(R21^2+2*R12*R21+R12^2)*Xb)
Xc4 = (sqrt((-4*R11*R22*Xb^2+R12^2*X21^2+(2*R12*R21-4*R11*R22)*X12*X21+R21^2*X12^2-4*R11^2*R22^2+4*R11*R12*R21*R22)*k^2+((-4*R11*R22+2*R12*R21+2*R12^2)*X21+(-4*R11*R22+2*R21^2+2*R12*R21)*X12)*Xb*k+(R21^2+2*R12*R21+R12^2)*Xb^2)+(R12*X21+R21*X12-2*R22*X11)*k+(R21+R12)*Xb)/(2*R22*k)
	
	
Zr1 = i*[[Xa1 Xb]; [Xb Xc1]];
Zr2 = i*[[Xa2 Xb]; [Xb Xc2]];
Zr3 = i*[[Xa3 Xb]; [Xb Xc3]];
Zr4 = i*[[Xa4 Xb]; [Xb Xc4]];

end